


collection
listeningStats
    document
    userId
        collection
        songId
            document
            stats
                plays
                skips
                location



collection
listeningStats
    document
    songId
        collection
        userId
            document
            stats
                songId
                albumId
                artistId
                labelId
                userId
                tagIds
                plays
                skips
                location
                latestTimeStamp

var userIdListeningStats = db.collectionGroup('stats').where('userId', '==', 'userId');

collection
songId
    document
    userId
        songId: uid
        albumId: uid
        artistId: uid
        labelId: uid
        userId: uid
        tagIds: ['uid','uid2']
        plays: number
        skips: number
        location: geoLocation
        createdAt: Date
        updatedAt: Date

Query for finding all plays by user of songId
var songIdRef = db.collection("songId");
var query = songsRef.where("userId", "==", uid);

collection
listeningStats
    document
    songId
        subcollection
        user
            document
            userId
                songId: uid
                albumId: uid
                artistId: uid
                labelId: uid
                userId: uid
                plays: number
                skips: number
                location: geoLocation
                createdAt: Date
                updatedAt: Date

Query for all listeningData for userId
var userIdListeningStats = db.collectionGroup('user').where('userId', '==', userId);

Query for all plays data for artistId
var artistIdPlayStats = db.collectionGroup('user').where('artistId', '==', artistId');

Query for all plays data for labelId
var labelIdPlayStats = db.collectionGroup('user').where('labelId', '==', labelId');

Query for all plays data for songId
var songIdPlayStats = db.collectionGroup('user').where('songId', '==', songId');

Query for all plays data for albumId
var songIdPlayStats = db.collectionGroup('user').where('albumId', '==', albumId');

Query listeningStats for songId plays by userId
var userIdSongIdStats = db.collectionGroup('user').where('userId', '==', userId').where('songId', '==', songId);
var userIdSongIdStats = db.collection('listeningStats').document(songId).collection('user').document(userId);

Query for plays in the last Month by userId
var userIdPlayedInTheLastMonth = db.collectionGroup('user').where('userId', '==', userId').where('updatedAt', '>=', moment().subtract(1, 'months'));



            